
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Stoxology - Stock Price Visualisation With Social Media News</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/style.css" rel="stylesheet">

    <!-- Custom styles for d3 -->
    <link href="css/stox-style.css" rel="stylesheet">

    <!-- Awesome Fonts -->
    <link rel="stylesheet" href="css/font-awesome.min.css">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <!-- <script src="../../assets/js/ie-emulation-modes-warning.js"></script> -->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div id="home" class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Stoxology</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="#intro">Intro</a></li>
            <li><a href="#data">Data</a></li>
            <li><a href="#visual">Visual</a></li>
            <li><a href="#credit">Credit</a></li>
            <li><a href="#resources">Resources</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <section>
      <div class="bg"></div>
      <div class="jumbotron">
        <div class="container">
          <img class ="logo-img" src="img/stoxology_logo.png" alt="Stoxology Logo">
          <div class ="main-title">Impact of news on stock prices visualised</div> 
        </div>
      </div>
    </section>

    <section>
      <div id="intro" class="container">
        <div class ="wrap">
          <div class="title">Information is money</div>
          <div class="text">
            <p>In the world of financial theories there are two types of people: those who believe in efficient markets and those who don't. Market efficiency means that prices incorporate the knowledge of the public, we often hear, for example, that certain actions in the world are priced in the stock as soon as it happens (i.e. new iPhone comes out, the stock movements reflect the public opinion). However, some are inexorably chasing for arbitrage and market inefficiency.</p>

            <p>With the Stoxology project we wanted to find a visual solution that helps the investigation of price-information correlation. It is up to a data scientist to find causality between news and stock price, or prove the opposite. What we are aiming at is facilitating this process. We believe that data visualisation is a tool that should not only be used for presenting results but also to discover new connections in the data.</p>
          </div>
        </div>
      </div>
    </section>

    <section class="data-background">
      <div id="data" class="container">
        <div class ="wrap">
          <div class="title">The Data</div>
          <div class="text">
            <p>We chose Lockheed Martin Corporation, a US defense and security company, traded in the New York Stock Exchange. Its stock has been performing exceptionally in the past year, despite the turmoil in all other markets. We wanted to know how the war related news in the world affect the stock price.</p>
            <p>We followed the twitter account of the Institute for the Study of War in Washington, captured the news articles they posted together with the number of re-tweets and likes of the actual post.</p>
            <p>The result is presented below. Each bubble shows the price level at a certain day. The bubble size represents the number of re-tweets and likes. If you hover over a bubble, a most important keyword of the news article will show together with the impact in price. The colors differentiate between keyword sentiments. </p>
            <p>Hope you will have fun playing!</p>
          </div>
        </div>
      </div>
    </section>

    <section>
      <div id="visual" class="container">
        <div class ="wrap">
          <div class="title">Lockheed Martin Corporation 10/2015 - 02/2016</div>
          <div class="diagram"></div>
        </div>
      </div>
    </section>

    <section>
      <div id="credit" class="container">
        <div class ="wrap">
          <div class="title">Credit</div>
          <div class="flex-container">
            <div class= "flex-item">
              <div class="credit-name">James Butler</div>
              <div class="hashtag">#backend #java #data</div>
              <div class="contact">
                <a href="#"><i class="fa fa-linkedin-square"></i></a>
                <a href="#"><i class="fa fa-github"></i></a>
              </div>
            </div>
            <div class= "flex-item">
              <div class="credit-name">Jaime Clinton</div>
              <div class="hashtag">#backend #java #data</div>
              <div class="contact">
                <a href="#"><i class="fa fa-linkedin-square"></i></a>
                <a href="#"><i class="fa fa-github"></i></a>
              </div>
            </div>
            <div class= "flex-item">
              <div class="credit-name">Nhim Kova</div>
              <div class="hashtag">#python #d3 #data #visual</div>
              <div class="contact">
                <a href="#"><i class="fa fa-linkedin-square"></i></a>
                <a href="#"><i class="fa fa-github"></i></a>
              </div>
            </div>
            <div class= "flex-item">
              <div class="credit-name">Sandra Szenti</div>
              <div class="hashtag">#frontend #javascript</div>
              <div class="contact">
                <a href="#"><i class="fa fa-linkedin-square"></i></a>
                <a href="#"><i class="fa fa-github"></i></a>
              </div>
            </div>
          </div>
          <div class="text"><p>Stoxology is a weekend project of a group of friends. The full project is open source.</p></div>
          <div class="text">
            <p><a href="https://github.com/stoxology/stoxology-backend/" target="_blank">Code of back end.</a></p>
          </div>
          <div class="text">
            <p><a href="https://github.com/stoxology/stoxology.github.io" target="_blank">Code of front end and data visualisation.</a></p>
          </div>
          
        </div>
      </div>
    </section>

    <section class="resources-background">
      <div id="resources" class="container">
        <div class ="wrap">
          <div class="title">Resources</div>
          <div class="text cast">
            <p><a href="http://www.alchemyapi.com/api/keyword-extraction" target="_blank">Alchemy Keyword Generator</a></p>
            <p><a href="https://uk.finance.yahoo.com/q?s=LMT" target="_blank">Stock prices from Yahoo Finance</a></p>
            <p><a href="https://www.hipsterlogogenerator.com/" target="_blank">Hispter Logo Generator</a></p>
            <p><a href="https://dev.twitter.com/overview/api" target="_blank">Twitter API</a></p>
            <p><a href="https://d3js.org/" target="_blank">D3 for data visualisation</a></p>
          </div>
        </div>
      </div>
    </section>
    
    <!-- D3
    ================================================== -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.4.1/d3.min.js"></script>
    <script src="http://labratrevenge.com/d3-tip/javascripts/d3.tip.v0.6.3.js"></script>
    <script>
      //Date parser
        var parseDate = d3.time.format("%Y/%m/%d");

        var margin = {top: 20, right: 20, bottom: 50, left: 40},
            width = 960 - margin.left - margin.right,
            height = 500 - margin.top - margin.bottom;

        var x = d3.time.scale.utc()
            .range([0, width]);

        var y = d3.scale.linear()
            .range([height, 0]);

        var xAxis = d3.svg.axis()
            .scale(x)
            .orient("bottom");

        var yAxis = d3.svg.axis()
            .scale(y)
            .orient("left");

        var svg = d3.select(".diagram").append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        var tip = d3.tip()
          .attr('class', 'd3-tip')
          //.offset([-10, 0])
          .html(function(d) {
            return "<span style='color:" +  direction(d.dailychange) + "'>" + (d.dailychange*100).toFixed(2) + "% </span>" + "<span style='color:orange'>" + d.keyword + "</span>";
          })

        svg.call(tip);

        d3.selection.prototype.moveToFront = function() {
          return this.each(function(){
            this.parentNode.appendChild(this);
          });
        };

        d3.selection.prototype.moveToBack = function() {  
                return this.each(function() { 
                var firstChild = this.parentNode.firstChild; 
                if (firstChild) { 
                    this.parentNode.insertBefore(this, firstChild); 
                } 
              }); 
            };

        // Reading in the data

        d3.csv("test.csv", type, function(error, data) {
          if (error) throw error;

          console.log(data)

          var color = d3.scale.ordinal()
          .domain(["positive", "negative", "neutral"])
          .range(["#66ff66", "#FF525E" , "#b3ffff"]);

          var darkcolor = d3.scale.ordinal()
          .domain(["positive", "negative", "neutral"])
          .range(["#128C12", "#B3525E" , "#1CBABA"]);

          x.domain([ new Date(data[ data.length - 1].date), new Date(data[0].date)])
            .rangeRound([0, width - margin.left - margin.right]);

          ymin = d3.min(data, function(d) { return d.price - 10.0; });
          ymax = d3.max(data, function(d) { return d.price + 10.0; });

          y.domain([ ymin, ymax ]);

          svg.append("g")
              .attr("class", "x axis")
              .attr("transform", "translate(0," + height + ")")
              .call(xAxis)
            .selectAll("text")
              .attr("y", 0)
              .attr("x", 9)
              .attr("dy", ".35em")
              .attr("transform", "rotate(45)")
              .style("text-anchor", "start")
            .append("text")
              .attr("class", "label")
              .attr("x", width)
              .attr("y", -6)
              .style("text-anchor", "end")
              .text("Date");

          svg.append("g")
              .attr("class", "y axis")
              .call(yAxis)
            .append("text")
              .attr("class", "label")
              .attr("transform", "rotate(-90)")
              .attr("y", 6)
              .attr("dy", ".71em")
              .style("text-anchor", "end")
              .text("Price(USD)")

          svg.selectAll("circle")
              .data(data)
              .enter()
              .append("circle")
                //.attr("class", "circle")
                .attr("cx", function(d) { return x(d.date); })
                .attr("cy", function(d) { return y(d.price); })
                .attr("r", function(d) { return Math.sqrt(d.score); })
                .style("fill", function(d) { return color(d.sentiment); });

        //Mouse over events for tooltip and circle transition
            d3.selectAll("circle")
              .on("mouseover", function(d) {
                d3.select(this).style("fill", function(d) { return darkcolor(d.sentiment); } );
                d3.select(this).moveToFront();
                tip.show(d);
            } )
              .on("mouseout", function(d) {
                d3.select(this).style("fill", function(d) { return color(d.sentiment); });
                d3.select(this).moveToBack();
            } );

          var legend = svg.selectAll(".legend")
              .data(color.domain())
            .enter().append("g")
              .attr("class", "legend")
              .attr("transform", function(d, i) { return "translate(0," + i * 20 + ")"; });

          legend.append("rect")
              .attr("x", width - 18)
              .attr("width", 18)
              .attr("height", 18)
              .style("fill", color);

          legend.append("text")
              .attr("x", width - 24)
              .attr("y", 9)
              .attr("dy", ".35em")
              .style("text-anchor", "end")
              .style("fill", "white")
              .text(function(d) { return d; });

        });

        function type(d) {
          d.price = +d.price;
          d.dailychange = d.dailychange;
          console.log(d.dailychange);
          d.sentiment = d.sentiment;
          d.score = +d.score;
          d.date = parseDate.parse(d.date);
          d.keyword = d.keyword;

          return d;
        }

        function direction(x) {
          if (x < 0.0) return "red";
          else return "lime";

        }

    </script>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="js/bootstrap.js"></script>
  </body>
</html>
